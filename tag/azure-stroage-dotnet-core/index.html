<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <script async data-ad-client=ca-pub-9563810810776580 src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script> <base href=/ > <link href=global.css rel=stylesheet> <link href=manifest.json rel=manifest crossorigin=use-credentials> <link href=favicon.png rel=icon type=image/png> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,null,{posts:[{title:"Develop for Azure Blob Storage and Amazon S3 without Subscription",description:"Learn how to develop storage solutions for Azure Blob Storage and Amazon S3 Storage without having a subscription",slug:"azure-blob-storage-amazon-s3-dotnet-core-without-subscription",html:"\u003Cp\u003E\u003Cimg src=\"azure-blob-storage-amazon-s3.png\" alt=\"Azure Storage - Amazon S3 Storage\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EWriting cloud software solutions have been never easier and more convient than now. But sometimes there are some barriers than prevent us, developers, from trying new technologies. For example not everybody has access to an Azure subscription or Amazon Cloud to try those cool cloudy things. But as always, there is a room. In this article we will look at two local deployable storage solutions that you can use both for developing cloud storage solutions and also for your on-premise customers.\u003C\u002Fp\u003E\n\u003Ch2 id=\"on-permise-storage-solutions\"\u003EOn-permise Storage Solutions:\u003C\u002Fh2\u003E\n\u003Col\u003E\n\u003Cli\u003EAzurite, Azure Storage API Compatible (Local\u002FDev Testing)\u003C\u002Fli\u003E\n\u003Cli\u003EZenko CloudServer, Amazon S3 Compatible (Production Ready)\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Ch1 id=\"azurite\"\u003EAzurite\u003C\u002Fh1\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002FAzure\u002FAzurite\"\u003EAzurite\u003C\u002Fa\u003E is a Node.js solution which is compatible with Azure Storage API and acts as an emulator of real Azure Storage. You can easily run it in your machine to develop and test your storage solution. Once you are happy with your code if you need to run it against Azure Storage, just change the configuration to an Azure Storage one and you&#39;re done.\u003C\u002Fp\u003E\n\u003Cp\u003EYou can run Azurite on docker with the following command just by replacing \u003Ccode\u003Ec:\u002Fazurite\u003C\u002Fcode\u003E with some path in your machine to store actual blob files:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003Edocker run -p 10000:10000 -p 10001:10001 -v c:\u002Fazurite:\u002Fdata mcr.microsoft.com\u002Fazure-storage\u002Fazurite\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EOnce you have the Azurite running, you can use the default connection string to connect to it via Azure Storage Explorer app or Azure Storage SDK:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003EDefaultEndpointsProtocol=http;AccountName=devstoreaccount1;AccountKey=Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq\u002FK1SZFPTOtr\u002FKBHBeksoGMGw==;BlobEndpoint=http:\u002F\u002F127.0.0.1:10000\u002Fdevstoreaccount1;QueueEndpoint=http:\u002F\u002F127.0.0.1:10001\u002Fdevstoreaccount1;\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ETo explore your Azurite instance install \u003Ca href=\"https:\u002F\u002Fazure.microsoft.com\u002Fen-us\u002Ffeatures\u002Fstorage-explorer\"\u003EAzure Storage Explorer\u003C\u002Fa\u003E and in the Add Account section select &quot;Local Storage Emulator&quot; and go ahead with default port numbers.\u003C\u002Fp\u003E\n\u003Cp\u003ETo develop your storage solution, first install Azure Blob Storage SDK nuget into your project\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003Edotnet add package Azure.Storage.Blobs\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EAnd with your Azurite connection string you can now do the following operations:\u003C\u002Fp\u003E\n\u003Ch3 id=\"create-an-azure-storage-container\"\u003ECreate an Azure Storage Container\u003C\u002Fh3\u003E\n\u003Cp\u003EYou can think of a container just like folders in your system.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003EBlobContainerClient container = new BlobContainerClient(connectionString, containerName);\n\ncontainer.Create();\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch3 id=\"upload-a-file-to-the-container\"\u003EUpload a file to the container\u003C\u002Fh3\u003E\n\u003Cpre\u003E\u003Ccode\u003EBlobContainerClient container = new BlobContainerClient(connectionString, containerName);\n\nBlobClient blob = container.GetBlobClient(blobName);\n\nblob.UploadFile(filePath);\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch3 id=\"download-a-file-from-the-container\"\u003EDownload a file from the container\u003C\u002Fh3\u003E\n\u003Cpre\u003E\u003Ccode\u003EBlobContainerClient container = new BlobContainerClient(connectionString, containerName);\n\nBlobClient blob = container.GetBlobClient(blobName);\n\nusing(FileStream downStream = new FileStream(donwloadFilePath, FileMode.Create))\n{\n    blob.DownloadTo(downStream);\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch1 id=\"zenko-cloudserver\"\u003EZenko CloudServer\u003C\u002Fh1\u003E\n\u003Cp\u003EThere are lots of S3 compatible storage solutions available in the market but not all of them can be used as an on-premise solution in commercial products specially if your software is closed source then you need to think about the licenses. Fortunately Zenko CloudServer has Apache 2.0 license which can be used in commercial products. \u003C\u002Fp\u003E\n\u003Cp\u003ETo run Zenko CloudServer in your machine, run it with the following docker command replacing the volume paths with some valid folders in your machine to store storage data:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003Edocker run -p 8000:8000 -v c:\u002Fcloudserver\u002Fdata:\u002Fusr\u002Fsrc\u002Fapp\u002FlocalData -v c:\u002Fcloudserver\u002Fmetadata\u002F\u002Fusr\u002Fsrc\u002Fapp\u002FlocalMetadata zenko\u002Fcloudserver\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ETo test if your storage is up and running you can use a S3 compatible client like \u003Ca href=\"https:\u002F\u002Fs3browser.com\u002F\"\u003ES3 Browser\u003C\u002Fa\u003E (Windows app). After installing that create a new account in the application with the following specifications:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EStorage Type: S3 Compatbile Storage\u003C\u002Fli\u003E\n\u003Cli\u003EREST Endpoint: 127.0.0.1:8000\u003C\u002Fli\u003E\n\u003Cli\u003EAccess Key Id: secretKey1 (default key, you can change it)\u003C\u002Fli\u003E\n\u003Cli\u003ESecret Access Key: verySecretKey1\u003C\u002Fli\u003E\n\u003Cli\u003EUse secure transfer (SSL\u002FTLS): Unchecked.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003ENow you can browse your Zenko CloudServer, create bucket and perform upload and download operations.\u003C\u002Fp\u003E\n\u003Cp\u003EWith your S3 storage ready, head over to your .NET Core application. Now you can perform the following operations on your S3 compatible storage:\u003C\u002Fp\u003E\n\u003Ch3 id=\"create-a-s3-client\"\u003ECreate a S3 client\u003C\u002Fh3\u003E\n\u003Cpre\u003E\u003Ccode\u003E    var accessKey = &quot;accessKey1&quot;;\n    var secretKey = &quot;verySecretKey1&quot;;\n\n    var config = new AmazonS3Config() {\n        ServiceURL = &quot;http:\u002F\u002F127.0.0.1:8000&quot;,\n        ForcePathStyle = true\n    };\n\n    \u002F\u002F Create an S3 client object.\n    var s3Client = new AmazonS3Client(accessKey, secretKey, config);\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch3 id=\"create-a-s3-bucket\"\u003ECreate a S3 bucket\u003C\u002Fh3\u003E\n\u003Cpre\u003E\u003Ccode\u003Eawait s3Client.PutBucketAsync(bucketName);\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch3 id=\"upload-a-file-to-s3-storage\"\u003EUpload a file to S3 storage\u003C\u002Fh3\u003E\n\u003Cpre\u003E\u003Ccode\u003E    \u002F\u002F key is the name of blob which will be created in storage\n    var key = Path.GetFileName(filePath);\n\n    var request = new UploadPartRequest()\n    {\n        BucketName = bucketName,\n        FilePath = filePath,\n        Key = key \n    };\n    await s3Client.UploadPartAsync(request);\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch3 id=\"download-a-file-from-s3-storage\"\u003EDownload a file from S3 storage\u003C\u002Fh3\u003E\n\u003Cpre\u003E\u003Ccode\u003E    var downloadRequest = new GetObjectRequest()\n    {\n        BucketName = bucketName,\n        Key = key \u002F\u002F the name of file in the bucket\n    };\n\n    var downloadResponse = await s3Client.GetObjectAsync(downloadRequest);\n\n    using(FileStream downStream = new FileStream(downloadPath, FileMode.Create))\n    {\n        downloadResponse.ResponseStream.CopyTo(downStream);\n    }\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EIn this tutorial we learned how to use some cool open-source projects to simulate Azure Blob Storage and Amazon S3 Storage for developing storage dependent parts of our projects. Also we performed three main storage operations: creating a bucket, uploading a file and downloading a file from these storages. More advanced features like resumable multi part upload and downloads with cancellation tokens can easily be developed with both Azure Storage and Amazon SDKs.\u003C\u002Fp\u003E\n\u003Cp\u003EEnjoy your data transfer with cloud storages ;-)\u003C\u002Fp\u003E\n\u003Ch3 id=\"references\"\u003EReferences\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002FAzure\u002Fazure-sdk-for-net\u002Fblob\u002Fmaster\u002Fsdk\u002Fstorage\u002FAzure.Storage.Blobs\u002FREADME.md\"\u003Ehttps:\u002F\u002Fgithub.com\u002FAzure\u002Fazure-sdk-for-net\u002Fblob\u002Fmaster\u002Fsdk\u002Fstorage\u002FAzure.Storage.Blobs\u002FREADME.md\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fdocs.aws.amazon.com\u002Fsdk-for-net\u002Fv3\u002Fdeveloper-guide\u002Fquick-start-s3-1-winvs.html\"\u003Ehttps:\u002F\u002Fdocs.aws.amazon.com\u002Fsdk-for-net\u002Fv3\u002Fdeveloper-guide\u002Fquick-start-s3-1-winvs.html\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002FAzure\u002FAzurite\"\u003Ehttps:\u002F\u002Fgithub.com\u002FAzure\u002FAzurite\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fwww.zenko.io\u002Fcloudserver\"\u003Ehttps:\u002F\u002Fwww.zenko.io\u002Fcloudserver\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n",tags:["azure-blob-storage","amazon-s3","s3-compatible","zenko","zenko-cloudserver","azurite","s3-emulator","blob-storage","local-storage","s3-dotnet-core","azure-stroage-dotnet-core"],updatedDate:"2021-03-05",image:"azure-blob-storage-amazon-s3.png"}]}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');(function(){try{eval("async function x(){}");var main="/client/client.f05c91d8.js"}catch(e){main="/client/legacy/client.9cb55970.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@2.0.4.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> <link href=client/client-e118e612.css rel=stylesheet> <title>Tagged posts</title> <link href=/client/client.f05c91d8.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/client-e118e612.css rel=preload as=style><link href=/client/[slug].0f78a3ee.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/inject_styles.5607aec6.js rel=modulepreload as=script crossorigin=use-credentials></head> <body> <div id=sapper> <nav class=svelte-1dbd5up><ul class=svelte-1dbd5up><li class=svelte-1dbd5up><a href=. class=svelte-1dbd5up>home</a></li> <li class=svelte-1dbd5up><a href=blog class=svelte-1dbd5up rel=prefetch>blog</a></li> <li class=svelte-1dbd5up><a href=tutorials class=svelte-1dbd5up>tutorials</a></li> <li class=svelte-1dbd5up><a href=about class=svelte-1dbd5up>about</a></ul></nav> <main class=svelte-1uhnsl8> <ul> <li><a href=blog/azure-blob-storage-amazon-s3-dotnet-core-without-subscription rel=prefetch>Develop for Azure Blob Storage and Amazon S3 without Subscription</a></ul></main></div> 